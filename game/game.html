<!DOCTYPE html>
<html>

<canvas id="elementCanvas" width="1600" height="700"> </canvas>
<script>
var canvas= document.getElementById("elementCanvas"),
context = canvas.getContext("2d"),
width = 1600,
height = 700,
speed = 200,
boundaryPieces = new Array();
x = 0,
topy = 0,
bottomy = 400,
dx = 0,
topdy = 0,
bottomdy = 0;

function getBoundaries() {
	while(x < 1350) {
		dx = 100 + 150 * Math.random();
		topdy = -100 + 200 * Math.random();
		bottomdy = -200 + 400 * Math.random();
		lastTopY = topy;
		lastBottomY = bottomy;

		x += dx;
		topy += topdy;
		bottomy += bottomdy;

		while(topy > 500) {
			topy -= 100;
		} 
		while(topy < 0) {
			topy += 100;
		}

		while(bottomy > 700) {
			bottomy -= 100;
		} 
		while(bottomy < 100) {
			bottomy += 100;
		}
		while(bottomy - topy < 80 || bottomy - topy + topdy < 80) {
			bottomy += 10
		}
		boundaryPieces.push([x, topy, bottomy]);
	}
}

function shiftScreen() {
	boundaryPieces.shift();
	shiftAmount = boundaryPieces[0][0];
	for(i = 0; i < boundaryPieces.length; i++) {
		boundaryPieces[i][0] -= shiftAmount;
	}
	x -= shiftAmount;
}

function paintBoundaries() {
	context.beginPath();
	context.lineWidth  = 10;
	context.strokeStyle = "#ff0000";
	for(i = 0; i < boundaryPieces.length - 1; i++) {
		context.moveTo(boundaryPieces[i][0], boundaryPieces[i][1]);
		context.lineTo(boundaryPieces[i + 1][0], boundaryPieces[i + 1][1]);
		context.stroke();

		context.moveTo(boundaryPieces[i][0], boundaryPieces[i][2]);
		context.lineTo(boundaryPieces[i + 1][0], boundaryPieces[i + 1][2]);
		context.stroke();
	}

	context.moveTo(boundaryPieces[0][0], boundaryPieces[0][1]);
	context.lineTo(boundaryPieces[0][0], boundaryPieces[0][2]);
	context.stroke();
}

function init() {
	boundaryPieces[0] = [0, 0, 400];
	setInterval(gameLoop, speed);
}

function gameLoop() {
	clearCanvas();
	getBoundaries();
	paintBoundaries();
	shiftScreen();
}

function clearCanvas() {
	context.clearRect(0,0,width,height);
}

//Stuff we won't need
function keyDown(e) {
	if (e.keyCode == 39) rightKey = true;
	else if (e.keyCode == 37) leftKey = true;
	if (e.keyCode == 38) upKey = true;
	else if (e.keyCode == 40) downKey = true;
}

function keyUp(e) {
	if (e.keyCode == 39) rightKey = false;
	else if (e.keyCode == 37) leftKey = false;
	if (e.keyCode == 38) upKey = false;
	else if (e.keyCode == 40) downKey = false;
}
window.onload = init;
</script>


</html>